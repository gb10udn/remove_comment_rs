# 1. プログラムの手順

- エクセルマクロの VBA コードの箇所が若干複雑に感じられたので、手順と共に、背景を記録しておく。

- 全て Rust で実施したかったが、エクセルブックへ VBA コードを削除する・書き込む機能を持ったクレートが見つからなかったため、Python の win32api モジュールを使用した。
  - Rust の `calamine` は読み込みはできるが、書き込みができなそうだった。(2024-03-13 時点)

| Step |  言語  | 主要ライブラリ |                                                      実行内容                                                       |
| ---- | ------ | -------------- | ------------------------------------------------------------------------------------------------------------------- |
| 1    | Rust   | calamine       | `.xlsm` ファイルから、VBA コードを取得し、メモリに格納する。                                                        |
| 2    | Rust   | Regex          | VBA コードで不要コメントを削除し、`.bas` ファイルとして保存する。(Rust -> Python はファイル渡し)                    |
| 3    | Python | win32api       | `.xlsm` のコピーをメモリに作成し、既存のVBA コード部分を削除する。                                                  |
| 4    | Python | win32api       | 不要コメント削除済みの `.bas` ファイルよ読み込み、メモリ上の `.xlsm` ファイルに追加し、`.xlsm` ファイルを保存する。 |